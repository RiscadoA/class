type rec Nat {
    choice of {
        |#Z: close
        |#S: Nat
    }
};;

proc zero(n:Nat) {
    #Z n;
    close n
};;

proc rec printNat(n:~Nat) {
    case n of {
        |#Z: println("Z"); wait n; ()
        |#S: print("S "); printNat(n)
    }
};;

proc main() {
    cut {
        #S n; #S n; zero(n)
        |n:~Nat|
        printNat(n)
    }
};;
