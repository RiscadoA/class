proc forward(x:wait, y:close) {
    fwd x y
};;

proc main() {
    cut {
        recv a(x);
        par {
            close x
            ||
            close a
        }
        |a:send wait; wait|
        send a(y. wait y; ());
        forward(a, b)
        |b:wait|
        wait b;
        ()
    }
};;
