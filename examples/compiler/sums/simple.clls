type close_or_wait {
    choice of {
        |#C: wait
        |#W: close
    }
};;

proc main() {
    cut {
        case x of {
            |#C: close x
            |#W: wait x; ()
        }
        |x: close_or_wait|
        #W x;
        close x
    }
};;
