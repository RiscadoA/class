cut {
    case x of {
        |#A: close x
        |#B: case x of {
            |#A: wait x; ()
            |#B: close x
        }
    }
    |x : choice of { |#A: wait |#B: choice of { |#A: close |#B: wait } }|
    #B x;
    #A x;
    close x
}
